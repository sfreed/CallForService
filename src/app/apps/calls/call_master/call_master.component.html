<dx-accordion
    #accordion
    [collapsible]="false"
    [multiple]="false"
    [animationDuration]="300"
    [height]="window.innerHeight / 2 - 35">
  <dxi-item title="Calls" class="accordianHeader">
    <div class="formSelectContainer">
        <div class="dx-field formSelect">
          <div class="dx-field-value" style="width: 100%;">
            <div style="display:table-cell; vertical-align: middle;  float: left">
                <dx-button
                icon="dx-icon dx-icon-column-chooser"
                (onClick)="showColumnChooser()">
              </dx-button>
            </div>
            <div style="display:table-cell; vertical-align: middle;  float: left; padding-left: 100px;">
              <dx-button
                text="Open Calls"
                (onClick)="filterCalls(1)">
              </dx-button>
            </div>
            <div style="display:table-cell; vertical-align: middle;  float: left; padding-left: 10px;">
              <dx-button
                text="Closed Calls"
                (onClick)="filterCalls(2)">
              </dx-button>
            </div>
            <div style="display:table-cell; vertical-align: middle;  float: right">
              <dx-select-box
                #callForm
                [dataSource]="callTypes"
                displayExpr="description"
                valueExpr="id">
              </dx-select-box>
            </div>
            <div style="display:table-cell; vertical-align: middle; float: right">
              <dx-button
                icon="tel"
                (onClick)="formSelected($event, callForm)">
              </dx-button>
            </div>
          </div>
        </div>
    </div>
    <dx-data-grid
        #mastergrid
        id="gridContainer" class="callGrid"
        [dataSource]="calls"
        [remoteOperations]="false"
        [allowColumnReordering]="true"
        [rowAlternationEnabled]="true"
        [showBorders]="true"
        [height]="window.innerHeight / 2 - 180"
        [focusedRowEnabled]="true"
        [focusedRowKey]="0"
        (onFocusedRowChanged)="selectionChanged($event)">
      <dxo-paging [pageSize]="20"></dxo-paging>
      <dxo-pager
          [showPageSizeSelector]="true"
          [allowedPageSizes]="[20, 40, 60]"
          [showInfo]="true">
      </dxo-pager>
      <dxo-filter-row [visible]="true"></dxo-filter-row>
      <dxo-header-filter [visible]="true"></dxo-header-filter>
      <dxo-selection mode="single"></dxo-selection>
      <dxo-sorting mode="multiple"> </dxo-sorting>
      <dxo-state-storing [enabled]="true" type="localStorage" storageKey="storage"></dxo-state-storing>

      <dxi-column dataField="typeId" dataType="string" [caption]="'Call Type'">
        <dxo-lookup [dataSource]="callTypes" valueExpr="id" displayExpr="description"> </dxo-lookup>
      </dxi-column>
      <dxi-column dataField="complainantPerson.fullName" dataType="string" [caption]="'Complainant'"></dxi-column>
      <dxi-column dataField="dispatchedByPerson.fullName" dataType="string" [caption]="'Dispatcher'"></dxi-column>
      <dxi-column dataField="callDispositionStatusId" dataType="string" [caption]="'Disposition Status'" [sortIndex]="0" sortOrder="asc" [visible]="false">
        <dxo-lookup [dataSource]="callDispositionStatus" valueExpr="id" displayExpr="callForServiceDispositionStatusDescription"></dxo-lookup>
      </dxi-column>
      <dxi-column dataField="receivedDateTime" dataType="string" [sortIndex]="1" sortOrder="desc" [format]="'shortDateShortTime'" [caption]="'Received Time'"></dxi-column>
      <dxi-column dataField="dispatchedDateTime" dataType="string" [format]="'shortDateShortTime'" [caption]="'Dispatched Time'"></dxi-column>

      <dxi-column dataField="onHoldDateTime" dataType="string" [format]="'shortDateShortTime'" [caption]="'On Hold Time'" [visible]="false"></dxi-column>
      <dxi-column dataField="closedDateTime" dataType="string" [format]="'shortDateShortTime'" [caption]="'Closed Time'" [visible]="false"></dxi-column>
      <dxi-column dataType="number" dataField="callForServiceCodePriorityOrder" [caption]="'Code Priority Order'" [visible]="false"></dxi-column>
      <dxi-column dataField="locationPrimary" dataType="string" [caption]="'Primary Location'" [visible]="false"></dxi-column>
      <dxi-column dataField="secondaryLocationLocation" dataType="string" [caption]="'Secondary Location'" [visible]="false"></dxi-column>
      <dxi-column dataType="boolean" dataField="isAlertTimeActive" [caption]="'Alert Active?'" [visible]="false"></dxi-column>
      <dxi-column dataType="number" dataField="alertTimeInterval" [caption]="'Alert Time Interval'" [visible]="false"></dxi-column>
      <dxi-column dataType="string" dataField="alertTimeStart" [caption]="'Alert Time Start'" [visible]="false"></dxi-column>
    </dx-data-grid>
  </dxi-item>

  <dxi-item title="Search" class="accordianHeader">
    <dx-form id="callForm" class="callForm" [formData]="searchCall" height="350" [colCount]="2">
      <dxi-item itemType="group" caption="Call Time Information" [widthRatio]="1">
        <dxi-item dataField="receivedDateTime" dataType="Date">
            <dx-date-box id="received-date" width="100%" [(value)]="searchCall.receivedDateTime"></dx-date-box>
        </dxi-item>
        <dxi-item dataField="dispatchedDateTime" dataType="Date">
          <dx-date-box id="dispatched-date" width="100%" [(value)]="searchCall.dispatchedDateTime"></dx-date-box>
        </dxi-item>
        <dxi-item dataField="onHoldDateTime" dataType="Date">
          <dx-date-box id="onhold-date" width="100%" [(value)]="searchCall.onHoldDateTime"></dx-date-box>
        </dxi-item>
        <dxi-item dataField="closedDateTime" dataType="Date">
          <dx-date-box id="closed-date" width="100%" [(value)]="searchCall.closedDateTime"></dx-date-box>
        </dxi-item>
      </dxi-item>
      <dxi-item itemType="group" caption="Call Information" [widthRatio]="1">
          <dxi-item dataField="callForServiceTypeId" dataType="string">
            <dxo-label text="Call Type"></dxo-label>
            <dx-select-box [dataSource]="callTypes" displayExpr="description" valueExpr="id" [value]="searchCall.callForServiceTypeId"></dx-select-box>
          </dxi-item>
          <dxi-item dataField="callForServiceDispositionStatusId" dataType="string">
            <dxo-label text="Call Disposition Status"></dxo-label>
            <dx-select-box [dataSource]="callDispositionStatus" displayExpr="callForServiceDispositionStatusDescription" valueExpr="id" [value]="searchCall.callForServiceDispositionStatusId"></dx-select-box>
          </dxi-item>
          <dxi-item dataField="dispatchByPerson" dataType="string">
            <dxo-label text="Dispatched By"></dxo-label>
            <dx-select-box [dataSource]="dispatchers" displayExpr="fullName" valueExpr="id" [value]="searchCall.dispatchedByPerson"></dx-select-box>
          </dxi-item>
          <dxi-item dataField="searchCall.complainantPerson.fullName" dataType="string">
            <dxo-label text="Complainant Name"></dxo-label>
          </dxi-item>
      </dxi-item>
      <dxi-item [colSpan]="2" itemType="button" horizontalAlignment="right" [buttonOptions]="buttonOptions"></dxi-item>
    </dx-form>
  </dxi-item>
</dx-accordion>

