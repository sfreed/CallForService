<dx-accordion
    #accordion
    [collapsible]="false"
    [multiple]="false"
    [animationDuration]="300"
    [height]="window.innerHeight / 2 - 35">
  <dxi-item title="Calls" class="accordianHeader">
    <div class="formSelectContainer">
        <div class="dx-field formSelect">
          <div class="dx-field-value" >
            <div style="display:table-cell; vertical-align: middle;">
              <dx-select-box
                #callForm
                [dataSource]="callForms"
                displayExpr="name"
                valueExpr="id">
              </dx-select-box>
            </div>
            <div style="display:table-cell; vertical-align: middle;">
              <dx-button
                icon="tel"
                (onClick)="formSelected($event, callForm)">
              </dx-button>
            </div>
          </div>
        </div>
    </div>
    <dx-data-grid id="gridContainer" class="callGrid"
        [dataSource]="calls"
        [remoteOperations]="false"
        [allowColumnReordering]="true"
        [rowAlternationEnabled]="true"
        [showBorders]="true"
        [height]="window.innerHeight / 2 - 180"
        (onSelectionChanged)="selectionChanged($event)">
      <dxo-editing
        mode="popup"
        [allowUpdating]="true">
      </dxo-editing>
      <dxo-paging [pageSize]="20"></dxo-paging>
      <dxo-pager
          [showPageSizeSelector]="true"
          [allowedPageSizes]="[20, 40, 60]"
          [showInfo]="true">
      </dxo-pager>
      <dxo-filter-row [visible]="true"></dxo-filter-row>
      <dxo-header-filter [visible]="true"></dxo-header-filter>
      <dxo-selection mode="single"></dxo-selection>
      <dxo-sorting mode="multiple"> </dxo-sorting>

      <dxi-column dataField="receivedDateTime" dataType="string" [sortIndex]="0" sortOrder="desc"></dxi-column>
      <dxi-column dataField="dispatchedDateTime" dataType="string"></dxi-column>
      <dxi-column dataField="dispatchByPersonId" dataType="string" [caption]="'Dispatcher'">
        <dxo-lookup
            [dataSource]="dispatchers.store()"
            valueExpr="id"
            displayExpr="fullName">
        </dxo-lookup>
      </dxi-column>
      <dxi-column dataField="callTypeId" dataType="string" [caption]="'Call Type'">
          <dxo-lookup
          [dataSource]="callTypes.store()"
          valueExpr="id"
          displayExpr="description">
      </dxo-lookup>
      </dxi-column>
      <dxi-column dataField="locationPrimary.city" dataType="string" [caption]="'City'"></dxi-column>
      <dxi-column dataType="string" [calculateCellValue]="getComplainantName" [caption]="'Complaintant'"></dxi-column>
    </dx-data-grid>
  </dxi-item>
  <dxi-item title="Search" class="accordianHeader">
    <dx-form id="callForm" class="callForm"
        [formData]="searchCall"
        height="350"
        [colCount]="2">
      <dxi-item itemType="group" caption="Call Information" [widthRatio]="1">
        <dxi-item dataField="date" dataType="date"></dxi-item>
        <dxi-item dataField="time" dataType="string"></dxi-item>
      </dxi-item>
      <dxi-item itemType="group" caption="Call Information" [widthRatio]="1">
          <dxi-item dataField="dispatcher_name" dataType="string"></dxi-item>
          <dxi-item dataField="call_type" dataType="string"></dxi-item>
          <dxi-item dataField="caller_name" dataType="string"></dxi-item>
      </dxi-item>
      <dxi-item [colSpan]="2"
         itemType="button"
        horizontalAlignment="right"
        [buttonOptions]="buttonOptions">
      </dxi-item>
    </dx-form>
  </dxi-item>
</dx-accordion>

